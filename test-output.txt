**********************
Windows PowerShell transcript start
Start time: 20260221163322
Username: LAPTOP-GBATDCIC\ethor
RunAs User: LAPTOP-GBATDCIC\ethor
Configuration Name: 
Machine: LAPTOP-GBATDCIC (Microsoft Windows NT 10.0.26200.0)
Host Application: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -NonInteractive -File run-tests.ps1
Process ID: 33064
PSVersion: 5.1.26100.7705
PSEdition: Desktop
PSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.26100.7705
BuildVersion: 10.0.26100.7705
CLRVersion: 4.0.30319.42000
WSManStackVersion: 3.0
PSRemotingProtocolVersion: 2.3
SerializationVersion: 1.1.0.1
**********************
Transcript started, output file is C:\Dev\identity-lifecycle\test-output.txt
Loading module...

Identity Lifecycle Sweep - Test Harness
========================================
Scenario files found: 5

  Loading: 01-BasicProgression.scenarios.ps1
  Running: 01-01: Active AD account (10 days inactive) -- no action
True
True
True
True
True
  Running: 01-02: Account exactly at InactivityDays boundary (90 days) -- Warning fires
True
True
True
True
  Running: 01-03: Account one day short of threshold (89 days) -- no action
True
True
True
  Running: 01-04: Account in Warning, 14 days elapsed -- Disabled fires
True
True
True
True
True
  Running: 01-05: Account in Warning, only 13 days elapsed -- no action yet
True
True
True
  Running: 01-06: Account in Disabled, 30 days elapsed -- Deletion fires
True
True
True
True
  Running: 01-07: Account in Disabled, only 29 days elapsed -- no progression yet
True
True
True
  Running: 01-08: Account already in Deletion -- no further action
True
True
True
  Running: 01-09: Entra-native account (90 days inactive) -- Warning fires without AD standard account check
True
True
True
True
  Loading: 02-GraceAndExternalChanges.scenarios.ps1
  Running: 02-01: External change on Disabled account -- re-enabled externally, moves to Grace stage
True
True
True
True
True
True
  Running: 02-02: Grace period active within GraceDays -- account held at Grace, no progression
True
True
True
True
  Running: 02-03: Activity detected during Grace -- lifecycle resets to None, state row removed
True
True
True
True
  Running: 02-04: Grace period expired (GraceDays elapsed, no activity) -- rewinds to Warning
True
True
True
True
  Running: 02-05: External change detected on Warning-stage account -- moves to Grace, blocks pending Disable
True
True
True
True
  Running: 02-06: Grace boundary -- exactly at GraceDays threshold still holds (lt, not le)
True
True
  Running: 02-07: Account externally disabled while in Warning -- quietly moves to Disabled, no notification sent
True
True
True
True
True
  Loading: 03-StandardAccountResolution.scenarios.ps1
  Running: 03-01: AD account -- no standard account found -- skipped and flagged
True
True
True
True
True
True
True
  Running: 03-02: AD account -- standard account resolved via prefix strip -- lifecycle proceeds
True
True
True
  Running: 03-03: AD account -- resolved via Description field (StandardAccount= token)
True
True
  Running: 03-04: Entra-native account -- Resolve-StandardAccount is never called -- lifecycle proceeds
True
True
True
  Running: 03-05: Mixed batch -- 1 unresolvable AD + 1 Entra + 1 resolvable AD
True
True
True
True
  Running: 03-06: Multiple unresolvable accounts -- all collected, no action taken
True
True
True
True
  Loading: 04-EdgeCases.scenarios.ps1
  Running: 04-01: Never logged on, account old enough (created 200 days ago) -- creation date used as baseline, Warning fires
True
True
  Running: 04-02: Null LastActivity but already in Warning -- no duplicate notification
True
True
  Running: 04-03: Orphan cleanup -- state row exists for an account no longer in either directory
True
True
True
  Running: 04-04: Deletion account -- no automatic further progression
True
True
True
True
  Running: 04-05: Account in Warning with recent activity -- stage held (no grace-based reset without grace period)
True
True
True
True
  Running: 04-06: Mixed AD + Entra batch -- both processed, counts correct
True
True
True
True
  Running: 04-07: Notification failure -- Errors incremented, state row NOT written
True
True
True
  Running: 04-08: Disable action failure -- Errors incremented, state row NOT written
True
True
True
True
  Running: 04-09: Remove action failure -- Errors incremented, state row NOT written
True
True
True
True
  Running: 04-10: StateTableAccountEnabled = $null (brand-new account) -- no external change detected
True
True
  Running: 04-11: AD account with synced Entra account -- Entra sign-in enriches LastActivity
True
True
True
  Running: 04-12: Exactly at DisableDays threshold (Warning 14 days old) -- Disabled fires
True
  Running: 04-14: Deletion stage reached but -EnableDeletion not set -- removal suppressed, account stays Disabled
True
True
True
True
True
  Running: 04-15: Never logged on, account recently created (30 days) -- creation date within threshold, no action
True
True
True
  Running: 04-16: Never logged on, created exactly at threshold (90 days) -- Warning fires
True
True
  Running: 04-17: Entra-native account never signed in, recently created (30 days) -- no action
True
True
  Running: 04-13: Empty working set (no accounts in either directory) -- sweep completes cleanly
True
True
True
  Loading: 05-MultiRun.scenarios.ps1
  Running: 05-01: Full lifecycle progression -- None -> Warning -> Disabled -> Deletion (3 runs)
True
True
True
True
True
True
True
True
True
True
True
  Running: 05-02: Grace stage interrupts progression -- Disabled -> Grace -> (held) -> Warning (4 runs)
True
True
True
True
True
True
True
True
True
  Running: 05-03: Activity during Grace resets lifecycle to None (2 runs)
True
True
True
True
True
True
  Running: 05-04: Multiple accounts cycling simultaneously -- counts are per-run totals
True
True
True
True
True
True
True
True
True
True
True

========================================
Results: 174 assertions  |  174 PASS  |  0 FAIL

Report: C:\Dev\identity-lifecycle\IdentityLifecycle\tests\reports\SweepTest-20260221-063323.html
**********************
Windows PowerShell transcript end
End time: 20260221163326
**********************
